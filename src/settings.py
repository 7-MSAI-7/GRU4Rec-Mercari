# -*- coding: utf-8 -*-
"""
μ΄ νμΌμ€ ν”„λ΅μ νΈ μ „μ²΄μ—μ„ μ‚¬μ©λλ” λ‹¤μ–‘ν• μ„¤μ •κ°’λ“¤μ„ λ¨μ•„λ‘λ” κ³³μ…λ‹λ‹¤.
λ°μ΄ν„° νμΌμ μ„μΉ, λ¨λΈμ κµ¬μ΅°, ν•™μµ νλΌλ―Έν„° λ“± μ¤‘μ”ν• κ°’λ“¤μ„ μ—¬κΈ°μ„ κ΄€λ¦¬ν•©λ‹λ‹¤.
μ΄ νμΌμ„ μμ •ν•λ©΄ μ½”λ“μ λ‹¤λ¥Έ λ¶€λ¶„μ„ λ³€κ²½ν•μ§€ μ•κ³ λ„ μ‹¤ν— μ„¤μ •μ„ μ‰½κ² λ°”κΏ€ μ μμµλ‹λ‹¤.
"""
import os
import torch

# π’» --- μ¥μΉ μ„¤μ • ---
# λ¨λΈμ„ CPUμ—μ„ μ‹¤ν–‰ν• μ§€, GPU(κ·Έλν”½μΉ΄λ“)μ—μ„ μ‹¤ν–‰ν• μ§€ μλ™μΌλ΅ κ²°μ •ν•©λ‹λ‹¤.
# GPU(cuda)κ°€ μμΌλ©΄ ν›¨μ”¬ λΉ λ¥΄κ² ν•™μµν•  μ μμµλ‹λ‹¤.
DEVICE = torch.device("cuda" if torch.cuda.is_available() else "cpu")

# π“‚ --- λ°μ΄ν„° λ° λ΅κ·Έ κ²½λ΅ μ„¤μ • ---
# Mercari μ‡Όν•‘λ° λ°μ΄ν„° νμΌμ΄ μλ” μ„μΉλ¥Ό μ§€μ •ν•©λ‹λ‹¤.
DATA_PATH = r"/home/j1star/datasets/merrec/20230501/00000000000[0-4].parquet"

# λ΅κ·Έ(ν”„λ΅κ·Έλ¨ μ‹¤ν–‰ κΈ°λ΅) νμΌμ„ μ €μ¥ν•  λ””λ ‰ν„°λ¦¬μ…λ‹λ‹¤.
LOG_FILE_DIR = "logs"

# π—ƒοΈ --- λ¨λΈ κ΄€λ ¨ νμΌ κ²½λ΅ μ„¤μ • ---
# ν•™μµλ λ¨λΈμ΄λ‚ λ°μ΄ν„° μ²λ¦¬ μ¤‘ μƒμ„±λλ” νμΌλ“¤μ„ μ €μ¥ν•  λ””λ ‰ν„°λ¦¬μ…λ‹λ‹¤.
MODEL_ARTIFACTS_DIR = "model_artifacts"
# μµμΆ… ν•™μµλ λ¨λΈμ νλΌλ―Έν„°κ°€ μ €μ¥λ  κ²½λ΅μ…λ‹λ‹¤.
MODEL_SAVE_PATH = os.path.join(MODEL_ARTIFACTS_DIR, "lastest_gru_recommender.pth")
# μ•„μ΄ν… μΈλ±μ¤μ™€ μ„λ² λ”©λ μ΄λ¦„(μ«μ λ²΅ν„°)μ„ λ§¤ν•‘ν• νμΌ κ²½λ΅μ…λ‹λ‹¤.
ITEM_IDX_NAME_PATH = os.path.join(MODEL_ARTIFACTS_DIR, "idx_to_embedded_name.pt")
# μ•„μ΄ν… IDμ™€ λ‚΄λ¶€ μΈλ±μ¤λ¥Ό λ§¤ν•‘ν• νμΌ κ²½λ΅μ…λ‹λ‹¤.
ITEM_ID_IDX_PATH = os.path.join(MODEL_ARTIFACTS_DIR, "item_id_to_idx.pkl")

# π“ --- λ°μ΄ν„° μ²λ¦¬ λ° λ¶„ν•  κ΄€λ ¨ μ„¤μ • ---
# μ»΄ν“¨ν„° λ©”λ¨λ¦¬κ°€ λ¶€μ΅±ν•  λ•, μ „μ²΄ λ°μ΄ν„° λ€μ‹  μΌλ¶€λ§ λ¶λ¬μ™€μ„ λΉ λ¥΄κ² ν…μ¤νΈν•΄λ³Ό μ μμµλ‹λ‹¤.
# (NoneμΌλ΅ μ„¤μ •ν•λ©΄ μ „μ²΄ λ°μ΄ν„°λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.)
N_ROWS_TO_LOAD = None
# π¶β€β™‚οΈπ¶β€β™€οΈπ¶ μ‚¬μ©μμ μ‡Όν•‘ κΈ°λ΅(μ‹ν€€μ¤)μ΄ μµμ† μ΄ κΈΈμ΄ μ΄μƒμ΄μ–΄μ•Ό ν•™μµ/κ²€μ¦/ν…μ¤νΈμ©μΌλ΅ μλ―Έκ°€ μλ‹¤κ³  νλ‹¨ν•©λ‹λ‹¤.
MIN_LEN_FOR_SEQ_SPLIT = 3

# π§  --- GRU λ¨λΈ κµ¬μ΅° μ„¤μ • ---
# π κ° μƒν’μ μ΄λ¦„(ν…μ¤νΈ)μ„ μ–Όλ§λ‚ μμ„Έν• μ«μ λ²΅ν„°λ΅ ν‘ν„ν• μ§€ κ²°μ •ν•©λ‹λ‹¤. μ«μκ°€ ν΄μλ΅ λ” μμ„Έν•μ§€λ§ κ³„μ‚°μ΄ λ³µμ΅ν•΄μ§‘λ‹λ‹¤.
NAME_EMBEDDING_DIM = 384
# β¨ κ° ν–‰λ™(μ: 'μƒν’λ³΄κΈ°', 'μΆ‹μ•„μ”')μ„ μ–Όλ§λ‚ μμ„Έν• μ«μ λ²΅ν„°λ΅ ν‘ν„ν• μ§€ κ²°μ •ν•©λ‹λ‹¤.
EVENT_EMBEDDING_DIM = 32
# π§  GRU λ¨λΈμ΄ ν• λ²μ— μ–Όλ§λ‚ λ§μ€ μ •λ³΄λ¥Ό κΈ°μ–µν• μ§€(κΈ°μ–µ μ©λ‰) κ²°μ •ν•©λ‹λ‹¤. λ†’μ„μλ΅ λ³µμ΅ν• ν¨ν„΄μ„ ν•™μµν•  μ μμµλ‹λ‹¤.
GRU_HIDDEN_DIM = 128
# πΆ GRU μΈµμ„ λ‡ κ°λ‚ μ“μ„μ§€ κ²°μ •ν•©λ‹λ‹¤. κΉμ„μλ΅ λ” λ³µμ΅ν• κ΄€κ³„λ¥Ό ν•™μµν•  μ μμ§€λ§ κ³Όμ ν•©μ μ„ν—μ΄ μμµλ‹λ‹¤.
GRU_NUM_LAYERS = 2
# π’§ ν•™μµ μ‹ λ¨λΈμ μΌλ¶€ μ—°κ²°μ„ λ¬΄μ‘μ„λ΅ λμ–΄μ„, λ¨λΈμ΄ ν•™μµ λ°μ΄ν„°μ—λ§ λ„λ¬΄ μμ΅΄ν•μ§€ μ•λ„λ΅(κ³Όμ ν•© λ°©μ§€) ν•©λ‹λ‹¤.
DROPOUT_RATE = 0.5

# π“¦ --- λ°μ΄ν„° λ΅λ” μ„¤μ • ---
# ν• λ²μ— λ¨λΈμ— λ‡ κ°μ λ°μ΄ν„°λ¥Ό λ¬¶μ–΄μ„ λ³΄μ—¬μ¤„μ§€ κ²°μ •ν•©λ‹λ‹¤. (ν•™μµμ μ•μ •μ„±κ³Ό μ†λ„μ— μν–¥μ„ μ¤λ‹λ‹¤.)
BATCH_SIZE = 256

# β™οΈ --- λ¨λΈ ν•™μµ κ΄€λ ¨ ν•μ΄νΌνλΌλ―Έν„° ---
# μ „μ²΄ λ°μ΄ν„°μ…‹μ„ μ΄ λ‡ λ² λ°λ³µν•΄μ„ ν•™μµν• μ§€ κ²°μ •ν•©λ‹λ‹¤.
N_EPOCHS = 40
# ν•™μµλ¥ : λ¨λΈμ΄ μ •λ‹µμ„ ν–¥ν•΄ μ–Όλ§λ‚ ν° λ³΄ν­μΌλ΅ λ‚μ•„κ°μ§€ κ²°μ •ν•©λ‹λ‹¤.
LEARNING_RATE = 0.0005
# κ°€μ¤‘μΉ κ°μ†: λ¨λΈμ νλΌλ―Έν„°(κ°€μ¤‘μΉ)κ°€ λ„λ¬΄ μ»¤μ§€λ” κ²ƒμ„ λ°©μ§€ν•μ—¬ κ³Όμ ν•©μ„ λ§‰λ” κΈ°μ μ…λ‹λ‹¤.
WEIGHT_DECAY = 0.001
# κ·Έλλ””μ–ΈνΈ ν΄λ¦¬ν•‘: ν•™μµ κ³Όμ •μ—μ„ λ¨λΈμ νλΌλ―Έν„°κ°€ λΉ„μ •μƒμ μΌλ΅ ν¬κ² μ—…λ°μ΄νΈλλ” κ²ƒμ„ λ°©μ§€ν•©λ‹λ‹¤.
CLIP_GRAD_NORM = 1.0

# κ·Έλλ””μ–ΈνΈ μ¶•μ  (Gradient Accumulation)
# λ‡ λ²μ λ―Έλ‹λ°°μΉ(mini-batch)λ§λ‹¤ κ·Έλλ””μ–ΈνΈλ¥Ό μ—…λ°μ΄νΈν• μ§€ κ²°μ •ν•©λ‹λ‹¤.
# μλ¥Ό λ“¤μ–΄, BATCH_SIZEκ°€ 128μ΄κ³  ACCUMULATION_STEPSκ°€ 4μ΄λ©΄,
# μ‹¤μ§μ μΈ λ°°μΉ μ‚¬μ΄μ¦λ” 128 * 4 = 512κ°€ λ©λ‹λ‹¤.
ACCUMULATION_STEPS = 4

# π― --- μ¶”λ΅  λ° ν‰κ°€ κ΄€λ ¨ μ„¤μ • ---
# μ¶”μ²μ„ μƒμ„±ν•  λ•, μƒμ„ λ‡ κ°μ μ•„μ΄ν…μ„ λ³΄μ—¬μ¤„μ§€ κ²°μ •ν•©λ‹λ‹¤.
TOP_N = 20
# λ¨λΈμ μ„±λ¥μ„ ν‰κ°€ν•  λ•, μƒμ„ λ‡ κ°μ μ¶”μ² κ²°κ³Ό μ•μ— μ •λ‹µμ΄ ν¬ν•¨λμ–΄ μλ”μ§€λ¥Ό κΈ°μ¤€μΌλ΅ μ‚Όμ„μ§€ κ²°μ •ν•©λ‹λ‹¤.
K_FOR_METRICS = 20
